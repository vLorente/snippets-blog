---

import ButtonLink from "@components/control/ButtonLink.astro"
import Section from "@components/Section.astro"
import WidgetWrapper from "@components/widget/WidgetWrapper.astro"
import { getCategoryList } from "@utils/content-utils"
import { getCategoryUrl } from "@utils/url-utils"

const categories = await getCategoryList()

const COLLAPSED_HEIGHT = "7.5rem"
const COLLAPSE_THRESHOLD = 5

const isCollapsed = categories.length >= COLLAPSE_THRESHOLD

interface Props {
    class?: string;
    style?: string;
}
const className = Astro.props.class
const style = Astro.props.style
---

<Section class:list={["overriden-hidden transition pb-4", className]}>
	<WidgetWrapper name="Categories" id="categories" isCollapsed={isCollapsed} collapsedHeight={COLLAPSED_HEIGHT}
	>
			{categories.map((c) =>
					<ButtonLink
							url={getCategoryUrl(c.name)!}
							badge={c.count}
							label=`View all posts in the ${c.name} category`
					>
							{c.name}
					</ButtonLink>
			)}
	</WidgetWrapper>
</Section>
